1000 2000 5000
1000, 1000
09/01/2020 11:04:20 AM  config_atac_scsmart_ka1000_knn1000_200826.py
09/01/2020 11:04:20 AM * Begin integration
09/01/2020 11:04:20 AM Metadata snatac_gene (54844, 13)
sys:1: DtypeWarning: Columns (64) have mixed types.Specify dtype option on import or set low_memory=False.
09/01/2020 11:04:21 AM Metadata smarter_cells (6244, 129)
09/01/2020 11:04:27 AM Feature matrix snatac_gene (6345, 54844)
09/01/2020 11:04:29 AM Feature matrix smarter_cells (5743, 6244)
09/01/2020 11:04:29 AM Done reading data
09/01/2020 11:04:29 AM Subsampling 1/3
09/01/2020 11:04:36 AM snatac_gene (43812, 13) (6345, 43812)
09/01/2020 11:04:39 AM smarter_cells (4993, 129) (5743, 4993)
09/01/2020 11:04:39 AM Smoothing within modalities...
09/01/2020 11:35:11 AM snatac_gene: 1832.3795342445374
09/01/2020 11:37:07 AM smarter_cells: 115.61708903312683
09/01/2020 11:37:07 AM Constructing a joint matrix...
09/01/2020 11:37:07 AM Imputing into snatac_gene space...
09/01/2020 11:37:07 AM for snatac_gene cells...
09/01/2020 11:37:07 AM for smarter_cells cells...
09/01/2020 11:42:58 AM Saved output to: /cndd2/fangming/projects/miniatlas/results/pcX_all_mop_2mods_atacrna_200826_ka1000_knn1000.npy.0
09/01/2020 11:42:58 AM Saved output to: /cndd2/fangming/projects/miniatlas/results/cells_all_mop_2mods_atacrna_200826_ka1000_knn1000.npy.0
09/01/2020 11:42:58 AM Done integration into a common PC space
09/01/2020 11:42:58 AM Subsampling 2/3
09/01/2020 11:43:02 AM snatac_gene (43828, 13) (6345, 43828)
09/01/2020 11:43:02 AM smarter_cells (5005, 129) (5743, 5005)
09/01/2020 11:43:02 AM Smoothing within modalities...
09/01/2020 12:16:16 PM snatac_gene: 1994.3323469161987
09/01/2020 12:18:08 PM smarter_cells: 111.70511627197266
09/01/2020 12:18:08 PM Constructing a joint matrix...
09/01/2020 12:18:08 PM Imputing into snatac_gene space...
09/01/2020 12:18:08 PM for snatac_gene cells...
09/01/2020 12:18:08 PM for smarter_cells cells...
09/01/2020 12:24:42 PM Saved output to: /cndd2/fangming/projects/miniatlas/results/pcX_all_mop_2mods_atacrna_200826_ka1000_knn1000.npy.1
09/01/2020 12:24:42 PM Saved output to: /cndd2/fangming/projects/miniatlas/results/cells_all_mop_2mods_atacrna_200826_ka1000_knn1000.npy.1
09/01/2020 12:24:42 PM Done integration into a common PC space
09/01/2020 12:24:42 PM Subsampling 3/3
09/01/2020 12:24:44 PM snatac_gene (43883, 13) (6345, 43883)
09/01/2020 12:24:45 PM smarter_cells (5052, 129) (5743, 5052)
09/01/2020 12:24:45 PM Smoothing within modalities...
09/01/2020 12:51:36 PM snatac_gene: 1611.4694571495056
09/01/2020 12:53:27 PM smarter_cells: 110.82046866416931
09/01/2020 12:53:27 PM Constructing a joint matrix...
09/01/2020 12:53:27 PM Imputing into snatac_gene space...
09/01/2020 12:53:27 PM for snatac_gene cells...
09/01/2020 12:53:27 PM for smarter_cells cells...
09/01/2020 12:58:09 PM Saved output to: /cndd2/fangming/projects/miniatlas/results/pcX_all_mop_2mods_atacrna_200826_ka1000_knn1000.npy.2
09/01/2020 12:58:09 PM Saved output to: /cndd2/fangming/projects/miniatlas/results/cells_all_mop_2mods_atacrna_200826_ka1000_knn1000.npy.2
09/01/2020 12:58:10 PM Done integration into a common PC space
Time used to build kNN map 0.8264460563659668
Time used to get kNN 167.35867142677307
Time used to build kNN map 0.2147386074066162
Time used to get kNN 12.770667314529419
Time used to build kNN map 0.9710073471069336
Time used to get kNN 201.5983386039734
Time used to build kNN map 0.13494873046875
Time used to get kNN 12.490495920181274
Time used to build kNN map 0.9421546459197998
Time used to get kNN 161.0005931854248
Time used to build kNN map 0.23549222946166992
Time used to get kNN 12.236679315567017
09/01/2020 12:58:18 PM corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka1000_knn1000
09/01/2020 12:58:18 PM Output: /cndd2/fangming/projects/scf_enhancers/results/corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka1000_knn1000_2_corrs.pkl
/cndd2/fangming/projects/scf_enhancers/results/corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka1000_knn1000_2_corrs_idx.pkl
/cndd2/fangming/projects/scf_enhancers/results/figures/corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka1000_knn1000_2_plot1.pdf
/cndd2/fangming/projects/scf_enhancers/results/figures/corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka1000_knn1000_2_plot1_v2.pdf
09/01/2020 12:58:18 PM corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka1000_knn1000
09/01/2020 12:58:18 PM Output: /cndd2/fangming/projects/scf_enhancers/results/corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka1000_knn1000_1_corrs.pkl
/cndd2/fangming/projects/scf_enhancers/results/corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka1000_knn1000_1_corrs_idx.pkl
/cndd2/fangming/projects/scf_enhancers/results/figures/corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka1000_knn1000_1_plot1.pdf
/cndd2/fangming/projects/scf_enhancers/results/figures/corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka1000_knn1000_1_plot1_v2.pdf
09/01/2020 12:58:18 PM corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka1000_knn1000
09/01/2020 12:58:18 PM Output: /cndd2/fangming/projects/scf_enhancers/results/corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka1000_knn1000_0_corrs.pkl
/cndd2/fangming/projects/scf_enhancers/results/corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka1000_knn1000_0_corrs_idx.pkl
/cndd2/fangming/projects/scf_enhancers/results/figures/corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka1000_knn1000_0_plot1.pdf
/cndd2/fangming/projects/scf_enhancers/results/figures/corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka1000_knn1000_0_plot1_v2.pdf
09/01/2020 12:58:18 PM <class 'numpy.ndarray'>_(6244,)_cell_smarter_cells.txt
09/01/2020 12:58:18 PM <class 'numpy.ndarray'>_(6244,)_cell_smarter_cells.txt
09/01/2020 12:58:18 PM <class 'numpy.ndarray'>_(6244,)_cell_smarter_cells.txt
09/01/2020 12:58:18 PM <class 'numpy.ndarray'>_(135665,)_cell_snatac_gene.txt
09/01/2020 12:58:18 PM <class 'numpy.ndarray'>_(135665,)_cell_snatac_gene.txt
09/01/2020 12:58:18 PM <class 'numpy.ndarray'>_(135665,)_cell_snatac_gene.txt
09/01/2020 12:58:18 PM <class 'numpy.ndarray'>_(32324,)_gene_smarter_cells.txt
09/01/2020 12:58:18 PM <class 'numpy.ndarray'>_(32324,)_gene_smarter_cells.txt
09/01/2020 12:58:18 PM <class 'numpy.ndarray'>_(32324,)_gene_smarter_cells.txt
09/01/2020 12:58:19 PM <class 'pandas.core.frame.DataFrame'>_(233514, 3)_enh.tsv
09/01/2020 12:58:19 PM <class 'pandas.core.frame.DataFrame'>_(233514, 3)_enh.tsv
09/01/2020 12:58:19 PM <class 'pandas.core.frame.DataFrame'>_(233514, 3)_enh.tsv
09/01/2020 12:58:22 PM <class 'scipy.sparse.csc.csc_matrix'>_(32324, 6244)_mat_smarter_cells.npz
09/01/2020 12:58:22 PM <class 'scipy.sparse.csc.csc_matrix'>_(32324, 6244)_mat_smarter_cells.npz
09/01/2020 12:58:22 PM <class 'scipy.sparse.csc.csc_matrix'>_(32324, 6244)_mat_smarter_cells.npz
09/01/2020 12:58:24 PM <class 'scipy.sparse.csc.csc_matrix'>_(233514, 135665)_mat_atac_snatac_gene.npz
09/01/2020 12:58:24 PM <class 'scipy.sparse.csc.csc_matrix'>_(233514, 135665)_mat_atac_snatac_gene.npz
09/01/2020 12:58:24 PM <class 'scipy.sparse.csc.csc_matrix'>_(233514, 135665)_mat_atac_snatac_gene.npz
09/01/2020 12:58:29 PM (5052, 43883)_(5052, 5052)_(32324, 5052)_(233514, 43883)
09/01/2020 12:58:29 PM (4993, 43812)_(4993, 4993)_(32324, 4993)_(233514, 43812)
09/01/2020 12:58:34 PM (5005, 43828)_(5005, 5005)_(32324, 5005)_(233514, 43828)
09/01/2020 01:09:58 PM (32324, 4993)_(233514, 4993)
09/01/2020 01:10:43 PM (32324, 5005)_(233514, 5005)
09/01/2020 01:11:05 PM (32324, 5052)_(233514, 5052)
/cndd2/fangming/venvs/routine/lib/python3.8/site-packages/scipy/stats/stats.py:2500: RuntimeWarning: invalid value encountered in true_divide
  return (a - mns) / sstd
09/01/2020 01:12:20 PM 0
09/01/2020 01:12:39 PM 100000
09/01/2020 01:12:56 PM 200000
09/01/2020 01:13:13 PM 300000
09/01/2020 01:13:29 PM 400000
09/01/2020 01:13:45 PM 500000
09/01/2020 01:14:02 PM 600000
09/01/2020 01:14:18 PM 700000
09/01/2020 01:14:35 PM 800000
09/01/2020 01:14:51 PM 900000
09/01/2020 01:15:07 PM 1000000
09/01/2020 01:15:23 PM 1100000
09/01/2020 01:15:40 PM 1200000
/cndd2/fangming/venvs/routine/lib/python3.8/site-packages/scipy/stats/stats.py:2500: RuntimeWarning: invalid value encountered in true_divide
  return (a - mns) / sstd
09/01/2020 01:15:52 PM 0
09/01/2020 01:15:57 PM 1300000
09/01/2020 01:16:13 PM 1400000
/cndd2/fangming/venvs/routine/lib/python3.8/site-packages/scipy/stats/stats.py:2500: RuntimeWarning: invalid value encountered in true_divide
  return (a - mns) / sstd
09/01/2020 01:16:14 PM 0
09/01/2020 01:16:30 PM 1500000
09/01/2020 01:16:45 PM 100000
09/01/2020 01:16:47 PM 1600000
09/01/2020 01:17:04 PM 1700000
09/01/2020 01:17:11 PM 100000
09/01/2020 01:17:21 PM 1800000
09/01/2020 01:17:35 PM 200000
09/01/2020 01:17:38 PM 1900000
09/01/2020 01:17:55 PM 2000000
09/01/2020 01:18:09 PM 200000
09/01/2020 01:18:12 PM 2100000
09/01/2020 01:18:25 PM 300000
09/01/2020 01:18:28 PM 2200000
09/01/2020 01:18:56 PM 2300000
09/01/2020 01:19:04 PM 300000
09/01/2020 01:19:14 PM 400000
09/01/2020 01:19:26 PM 2400000
09/01/2020 01:19:55 PM 2500000
09/01/2020 01:20:09 PM 400000
09/01/2020 01:20:13 PM 500000
09/01/2020 01:20:26 PM 0
09/01/2020 01:21:23 PM 600000
09/01/2020 01:21:29 PM 500000
09/01/2020 01:21:40 PM 100000
09/01/2020 01:22:19 PM 700000
09/01/2020 01:22:31 PM 600000
09/01/2020 01:22:37 PM 200000
09/01/2020 01:23:31 PM 300000
09/01/2020 01:24:04 PM 800000
09/01/2020 01:24:24 PM 400000
09/01/2020 01:24:43 PM 700000
09/01/2020 01:25:20 PM 500000
09/01/2020 01:26:15 PM 600000
09/01/2020 01:26:27 PM 900000
09/01/2020 01:27:10 PM 700000
09/01/2020 01:27:13 PM 800000
09/01/2020 01:28:06 PM 800000
09/01/2020 01:28:51 PM 1000000
09/01/2020 01:28:59 PM 900000
09/01/2020 01:29:41 PM 900000
09/01/2020 01:29:54 PM 1000000
09/01/2020 01:30:52 PM 1100000
09/01/2020 01:31:13 PM 1100000
09/01/2020 01:31:47 PM 1200000
09/01/2020 01:32:11 PM 1000000
09/01/2020 01:32:42 PM 1300000
09/01/2020 01:33:06 PM 1200000
09/01/2020 01:33:31 PM 1100000
09/01/2020 01:33:36 PM 1400000
09/01/2020 01:34:02 PM 1300000
09/01/2020 01:34:33 PM 1500000
09/01/2020 01:34:34 PM 1200000
09/01/2020 01:34:59 PM 1400000
09/01/2020 01:35:29 PM 1600000
09/01/2020 01:35:37 PM 1300000
09/01/2020 01:35:55 PM 1500000
09/01/2020 01:36:26 PM 1700000
09/01/2020 01:36:40 PM 1400000
09/01/2020 01:36:53 PM 1600000
09/01/2020 01:37:23 PM 1800000
09/01/2020 01:37:41 PM 1500000
09/01/2020 01:37:51 PM 1700000
09/01/2020 01:38:19 PM 1900000
09/01/2020 01:38:43 PM 1600000
09/01/2020 01:38:49 PM 1800000
09/01/2020 01:39:23 PM 2000000
09/01/2020 01:39:46 PM 1700000
09/01/2020 01:39:46 PM 1900000
09/01/2020 01:40:30 PM 2100000
09/01/2020 01:40:45 PM 2000000
09/01/2020 01:40:51 PM 1800000
09/01/2020 01:41:24 PM 2200000
09/01/2020 01:41:43 PM 2100000
09/01/2020 01:41:54 PM 1900000
09/01/2020 01:42:19 PM 2300000
09/01/2020 01:42:41 PM 2200000
09/01/2020 01:42:58 PM 2000000
09/01/2020 01:43:14 PM 2400000
09/01/2020 01:43:37 PM 2300000
09/01/2020 01:43:59 PM 2100000
09/01/2020 01:44:08 PM 2500000
09/01/2020 01:44:35 PM 2400000
09/01/2020 01:44:55 PM 0
09/01/2020 01:45:02 PM 2200000
09/01/2020 01:45:25 PM 100000
09/01/2020 01:45:31 PM 2500000
09/01/2020 01:46:02 PM 200000
09/01/2020 01:46:03 PM 2300000
09/01/2020 01:46:23 PM 0
09/01/2020 01:46:46 PM 300000
09/01/2020 01:47:03 PM 2400000
09/01/2020 01:47:24 PM 100000
09/01/2020 01:47:32 PM 400000
09/01/2020 01:48:04 PM 2500000
09/01/2020 01:48:19 PM 500000
09/01/2020 01:48:24 PM 200000
09/01/2020 01:48:38 PM 600000
09/01/2020 01:48:58 PM 700000
09/01/2020 01:49:03 PM 0
09/01/2020 01:49:21 PM 300000
09/01/2020 01:49:21 PM 800000
09/01/2020 01:49:46 PM 900000
09/01/2020 01:50:03 PM 100000
09/01/2020 01:50:11 PM 1000000
09/01/2020 01:50:21 PM 400000
09/01/2020 01:50:37 PM 1100000
09/01/2020 01:51:03 PM 1200000
09/01/2020 01:51:04 PM 200000
09/01/2020 01:51:21 PM 500000
09/01/2020 01:51:31 PM 1300000
09/01/2020 01:51:58 PM 1400000
09/01/2020 01:52:03 PM 300000
09/01/2020 01:52:21 PM 600000
09/01/2020 01:52:24 PM 1500000
09/01/2020 01:52:50 PM 1600000
09/01/2020 01:53:01 PM 400000
09/01/2020 01:53:17 PM 1700000
09/01/2020 01:53:22 PM 700000
09/01/2020 01:53:44 PM 1800000
09/01/2020 01:53:58 PM 500000
09/01/2020 01:54:11 PM 1900000
09/01/2020 01:54:22 PM 800000
09/01/2020 01:54:37 PM 2000000
09/01/2020 01:54:57 PM 600000
09/01/2020 01:55:03 PM 2100000
09/01/2020 01:55:23 PM 900000
09/01/2020 01:55:29 PM 2200000
09/01/2020 01:55:55 PM 2300000
09/01/2020 01:55:56 PM 700000
09/01/2020 01:56:22 PM 2400000
09/01/2020 01:56:23 PM 1000000
09/01/2020 01:56:49 PM 2500000
09/01/2020 01:56:54 PM 800000
09/01/2020 01:57:13 PM (2589994,)_(2589994,)_(2589994,)
09/01/2020 01:57:13 PM 2062_1000000
09/01/2020 01:57:23 PM 1100000
../correlation_analysis_celllevel-v4-stage3.py:334: RuntimeWarning: divide by zero encountered in true_divide
  fdr = cdf_shuff/cdf
../correlation_analysis_celllevel-v4-stage3.py:334: RuntimeWarning: invalid value encountered in true_divide
  fdr = cdf_shuff/cdf
../correlation_analysis_celllevel-v4-stage3.py:335: RuntimeWarning: invalid value encountered in true_divide
  tracks_hist_ratios[label] = hist/hist_shuff
../correlation_analysis_celllevel-v4-stage3.py:335: RuntimeWarning: divide by zero encountered in true_divide
  tracks_hist_ratios[label] = hist/hist_shuff
09/01/2020 01:57:46 PM 900000
09/01/2020 01:58:16 PM 1200000
09/01/2020 01:58:36 PM 1000000
09/01/2020 01:59:12 PM 1300000
09/01/2020 01:59:27 PM 1100000
09/01/2020 02:00:10 PM 1400000
09/01/2020 02:00:25 PM 1200000
09/01/2020 02:01:09 PM 1500000
09/01/2020 02:01:23 PM 1300000
09/01/2020 02:02:08 PM 1600000
09/01/2020 02:02:21 PM 1400000
09/01/2020 02:03:06 PM 1700000
09/01/2020 02:03:14 PM 1500000
09/01/2020 02:04:03 PM 1800000
09/01/2020 02:04:10 PM 1600000
09/01/2020 02:05:00 PM 1900000
09/01/2020 02:05:06 PM 1700000
09/01/2020 02:05:57 PM 2000000
09/01/2020 02:06:05 PM 1800000
09/01/2020 02:06:52 PM 2100000
09/01/2020 02:07:01 PM 1900000
09/01/2020 02:07:49 PM 2200000
09/01/2020 02:07:58 PM 2000000
09/01/2020 02:08:48 PM 2300000
09/01/2020 02:08:54 PM 2100000
09/01/2020 02:09:43 PM 2400000
09/01/2020 02:09:51 PM 2200000
09/01/2020 02:10:40 PM 2500000
09/01/2020 02:10:48 PM 2300000
09/01/2020 02:11:34 PM 0
09/01/2020 02:11:47 PM 2400000
09/01/2020 02:12:27 PM 100000
09/01/2020 02:12:42 PM 2500000
09/01/2020 02:13:21 PM 200000
09/01/2020 02:13:33 PM 0
09/01/2020 02:14:09 PM 300000
09/01/2020 02:14:33 PM 100000
09/01/2020 02:15:00 PM 400000
09/01/2020 02:15:33 PM 200000
09/01/2020 02:15:51 PM 500000
09/01/2020 02:16:33 PM 300000
09/01/2020 02:16:48 PM 600000
09/01/2020 02:17:39 PM 400000
09/01/2020 02:17:48 PM 700000
09/01/2020 02:18:39 PM 500000
09/01/2020 02:18:42 PM 800000
09/01/2020 02:19:31 PM 900000
09/01/2020 02:19:36 PM 600000
09/01/2020 02:20:17 PM 1000000
09/01/2020 02:20:28 PM 700000
09/01/2020 02:21:01 PM 1100000
09/01/2020 02:21:23 PM 800000
09/01/2020 02:21:47 PM 1200000
09/01/2020 02:22:14 PM 900000
09/01/2020 02:22:35 PM 1300000
09/01/2020 02:23:08 PM 1000000
09/01/2020 02:23:24 PM 1400000
09/01/2020 02:24:04 PM 1100000
09/01/2020 02:24:10 PM 1500000
09/01/2020 02:24:58 PM 1200000
09/01/2020 02:24:58 PM 1600000
09/01/2020 02:25:56 PM 1700000
09/01/2020 02:25:59 PM 1300000
09/01/2020 02:26:54 PM 1800000
09/01/2020 02:27:02 PM 1400000
09/01/2020 02:27:51 PM 1900000
09/01/2020 02:28:05 PM 1500000
09/01/2020 02:28:49 PM 2000000
09/01/2020 02:29:09 PM 1600000
09/01/2020 02:29:46 PM 2100000
09/01/2020 02:30:15 PM 1700000
09/01/2020 02:30:45 PM 2200000
09/01/2020 02:31:20 PM 1800000
09/01/2020 02:31:42 PM 2300000
09/01/2020 02:32:24 PM 1900000
09/01/2020 02:32:40 PM 2400000
09/01/2020 02:33:23 PM 2000000
09/01/2020 02:33:32 PM 2500000
09/01/2020 02:34:13 PM (2589994,)_(2589994,)_(2589994,)
09/01/2020 02:34:13 PM 2062_1000000
09/01/2020 02:34:21 PM 2100000
../correlation_analysis_celllevel-v4-stage3.py:334: RuntimeWarning: divide by zero encountered in true_divide
  fdr = cdf_shuff/cdf
../correlation_analysis_celllevel-v4-stage3.py:334: RuntimeWarning: invalid value encountered in true_divide
  fdr = cdf_shuff/cdf
../correlation_analysis_celllevel-v4-stage3.py:335: RuntimeWarning: invalid value encountered in true_divide
  tracks_hist_ratios[label] = hist/hist_shuff
../correlation_analysis_celllevel-v4-stage3.py:335: RuntimeWarning: divide by zero encountered in true_divide
  tracks_hist_ratios[label] = hist/hist_shuff
09/01/2020 02:34:51 PM 2200000
09/01/2020 02:35:18 PM 2300000
09/01/2020 02:35:46 PM 2400000
09/01/2020 02:36:14 PM 2500000
09/01/2020 02:36:39 PM (2589994,)_(2589994,)_(2589994,)
09/01/2020 02:36:39 PM 2062_1000000
../correlation_analysis_celllevel-v4-stage3.py:334: RuntimeWarning: divide by zero encountered in true_divide
  fdr = cdf_shuff/cdf
../correlation_analysis_celllevel-v4-stage3.py:334: RuntimeWarning: invalid value encountered in true_divide
  fdr = cdf_shuff/cdf
../correlation_analysis_celllevel-v4-stage3.py:335: RuntimeWarning: divide by zero encountered in true_divide
  tracks_hist_ratios[label] = hist/hist_shuff
../correlation_analysis_celllevel-v4-stage3.py:335: RuntimeWarning: invalid value encountered in true_divide
  tracks_hist_ratios[label] = hist/hist_shuff
2000, 2000
09/01/2020 02:36:59 PM  config_atac_scsmart_ka2000_knn2000_200826.py
09/01/2020 02:37:00 PM * Begin integration
09/01/2020 02:37:00 PM Metadata snatac_gene (54844, 13)
sys:1: DtypeWarning: Columns (64) have mixed types.Specify dtype option on import or set low_memory=False.
09/01/2020 02:37:00 PM Metadata smarter_cells (6244, 129)
09/01/2020 02:37:03 PM Feature matrix snatac_gene (6345, 54844)
09/01/2020 02:37:04 PM Feature matrix smarter_cells (5743, 6244)
09/01/2020 02:37:04 PM Done reading data
09/01/2020 02:37:04 PM Subsampling 1/3
09/01/2020 02:37:07 PM snatac_gene (43991, 13) (6345, 43991)
09/01/2020 02:37:07 PM smarter_cells (4993, 129) (5743, 4993)
09/01/2020 02:37:07 PM Smoothing within modalities...
09/01/2020 03:25:17 PM snatac_gene: 2889.5678753852844
09/01/2020 03:27:47 PM smarter_cells: 149.9644501209259
09/01/2020 03:27:47 PM Constructing a joint matrix...
09/01/2020 03:27:47 PM Imputing into snatac_gene space...
09/01/2020 03:27:47 PM for snatac_gene cells...
09/01/2020 03:27:47 PM for smarter_cells cells...
09/01/2020 03:33:14 PM Saved output to: /cndd2/fangming/projects/miniatlas/results/pcX_all_mop_2mods_atacrna_200826_ka2000_knn2000.npy.0
09/01/2020 03:33:14 PM Saved output to: /cndd2/fangming/projects/miniatlas/results/cells_all_mop_2mods_atacrna_200826_ka2000_knn2000.npy.0
09/01/2020 03:33:14 PM Done integration into a common PC space
09/01/2020 03:33:14 PM Subsampling 2/3
09/01/2020 03:33:16 PM snatac_gene (43945, 13) (6345, 43945)
09/01/2020 03:33:17 PM smarter_cells (4982, 129) (5743, 4982)
09/01/2020 03:33:17 PM Smoothing within modalities...
09/01/2020 04:21:42 PM snatac_gene: 2904.9533574581146
09/01/2020 04:24:13 PM smarter_cells: 151.0849461555481
09/01/2020 04:24:13 PM Constructing a joint matrix...
09/01/2020 04:24:13 PM Imputing into snatac_gene space...
09/01/2020 04:24:13 PM for snatac_gene cells...
09/01/2020 04:24:13 PM for smarter_cells cells...
09/01/2020 04:30:02 PM Saved output to: /cndd2/fangming/projects/miniatlas/results/pcX_all_mop_2mods_atacrna_200826_ka2000_knn2000.npy.1
09/01/2020 04:30:02 PM Saved output to: /cndd2/fangming/projects/miniatlas/results/cells_all_mop_2mods_atacrna_200826_ka2000_knn2000.npy.1
09/01/2020 04:30:02 PM Done integration into a common PC space
09/01/2020 04:30:02 PM Subsampling 3/3
09/01/2020 04:30:04 PM snatac_gene (43916, 13) (6345, 43916)
09/01/2020 04:30:05 PM smarter_cells (5012, 129) (5743, 5012)
09/01/2020 04:30:05 PM Smoothing within modalities...
09/01/2020 05:17:51 PM snatac_gene: 2865.9629743099213
09/01/2020 05:20:26 PM smarter_cells: 155.35957551002502
09/01/2020 05:20:26 PM Constructing a joint matrix...
09/01/2020 05:20:26 PM Imputing into snatac_gene space...
09/01/2020 05:20:26 PM for snatac_gene cells...
09/01/2020 05:20:26 PM for smarter_cells cells...
09/01/2020 05:26:15 PM Saved output to: /cndd2/fangming/projects/miniatlas/results/pcX_all_mop_2mods_atacrna_200826_ka2000_knn2000.npy.2
09/01/2020 05:26:15 PM Saved output to: /cndd2/fangming/projects/miniatlas/results/cells_all_mop_2mods_atacrna_200826_ka2000_knn2000.npy.2
09/01/2020 05:26:15 PM Done integration into a common PC space
Time used to build kNN map 0.8399999141693115
Time used to get kNN 317.34661531448364
Time used to build kNN map 0.1396312713623047
Time used to get kNN 19.13463544845581
Time used to build kNN map 0.8575963973999023
Time used to get kNN 290.47249484062195
Time used to build kNN map 0.11685371398925781
Time used to get kNN 19.33732533454895
Time used to build kNN map 0.81174635887146
Time used to get kNN 303.99853253364563
Time used to build kNN map 0.17180585861206055
Time used to get kNN 20.82737898826599
09/01/2020 05:26:18 PM corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka2000_knn2000
09/01/2020 05:26:18 PM Output: /cndd2/fangming/projects/scf_enhancers/results/corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka2000_knn2000_1_corrs.pkl
/cndd2/fangming/projects/scf_enhancers/results/corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka2000_knn2000_1_corrs_idx.pkl
/cndd2/fangming/projects/scf_enhancers/results/figures/corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka2000_knn2000_1_plot1.pdf
/cndd2/fangming/projects/scf_enhancers/results/figures/corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka2000_knn2000_1_plot1_v2.pdf
09/01/2020 05:26:18 PM <class 'numpy.ndarray'>_(6244,)_cell_smarter_cells.txt
09/01/2020 05:26:18 PM corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka2000_knn2000
09/01/2020 05:26:18 PM Output: /cndd2/fangming/projects/scf_enhancers/results/corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka2000_knn2000_2_corrs.pkl
/cndd2/fangming/projects/scf_enhancers/results/corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka2000_knn2000_2_corrs_idx.pkl
/cndd2/fangming/projects/scf_enhancers/results/figures/corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka2000_knn2000_2_plot1.pdf
/cndd2/fangming/projects/scf_enhancers/results/figures/corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka2000_knn2000_2_plot1_v2.pdf
09/01/2020 05:26:18 PM <class 'numpy.ndarray'>_(6244,)_cell_smarter_cells.txt
09/01/2020 05:26:18 PM corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka2000_knn2000
09/01/2020 05:26:18 PM Output: /cndd2/fangming/projects/scf_enhancers/results/corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka2000_knn2000_0_corrs.pkl
/cndd2/fangming/projects/scf_enhancers/results/corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka2000_knn2000_0_corrs_idx.pkl
/cndd2/fangming/projects/scf_enhancers/results/figures/corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka2000_knn2000_0_plot1.pdf
/cndd2/fangming/projects/scf_enhancers/results/figures/corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka2000_knn2000_0_plot1_v2.pdf
09/01/2020 05:26:18 PM <class 'numpy.ndarray'>_(6244,)_cell_smarter_cells.txt
09/01/2020 05:26:18 PM <class 'numpy.ndarray'>_(135665,)_cell_snatac_gene.txt
09/01/2020 05:26:18 PM <class 'numpy.ndarray'>_(135665,)_cell_snatac_gene.txt
09/01/2020 05:26:18 PM <class 'numpy.ndarray'>_(135665,)_cell_snatac_gene.txt
09/01/2020 05:26:19 PM <class 'numpy.ndarray'>_(32324,)_gene_smarter_cells.txt
09/01/2020 05:26:19 PM <class 'numpy.ndarray'>_(32324,)_gene_smarter_cells.txt
09/01/2020 05:26:19 PM <class 'numpy.ndarray'>_(32324,)_gene_smarter_cells.txt
09/01/2020 05:26:19 PM <class 'pandas.core.frame.DataFrame'>_(233514, 3)_enh.tsv
09/01/2020 05:26:19 PM <class 'pandas.core.frame.DataFrame'>_(233514, 3)_enh.tsv
09/01/2020 05:26:19 PM <class 'pandas.core.frame.DataFrame'>_(233514, 3)_enh.tsv
09/01/2020 05:26:21 PM <class 'scipy.sparse.csc.csc_matrix'>_(32324, 6244)_mat_smarter_cells.npz
09/01/2020 05:26:21 PM <class 'scipy.sparse.csc.csc_matrix'>_(32324, 6244)_mat_smarter_cells.npz
09/01/2020 05:26:21 PM <class 'scipy.sparse.csc.csc_matrix'>_(32324, 6244)_mat_smarter_cells.npz
09/01/2020 05:26:22 PM <class 'scipy.sparse.csc.csc_matrix'>_(233514, 135665)_mat_atac_snatac_gene.npz
09/01/2020 05:26:22 PM <class 'scipy.sparse.csc.csc_matrix'>_(233514, 135665)_mat_atac_snatac_gene.npz
09/01/2020 05:26:22 PM <class 'scipy.sparse.csc.csc_matrix'>_(233514, 135665)_mat_atac_snatac_gene.npz
09/01/2020 05:26:27 PM (5012, 43916)_(5012, 5012)_(32324, 5012)_(233514, 43916)
09/01/2020 05:26:34 PM (4982, 43945)_(4982, 4982)_(32324, 4982)_(233514, 43945)
09/01/2020 05:26:37 PM (4993, 43991)_(4993, 4993)_(32324, 4993)_(233514, 43991)
09/01/2020 05:46:03 PM (32324, 5012)_(233514, 5012)
09/01/2020 05:46:17 PM (32324, 4982)_(233514, 4982)
09/01/2020 05:46:20 PM (32324, 4993)_(233514, 4993)
/cndd2/fangming/venvs/routine/lib/python3.8/site-packages/scipy/stats/stats.py:2500: RuntimeWarning: invalid value encountered in true_divide
  return (a - mns) / sstd
09/01/2020 06:03:56 PM 0
09/01/2020 06:05:00 PM 100000
09/01/2020 06:05:59 PM 200000
/cndd2/fangming/venvs/routine/lib/python3.8/site-packages/scipy/stats/stats.py:2500: RuntimeWarning: invalid value encountered in true_divide
  return (a - mns) / sstd
09/01/2020 06:06:30 PM 0
/cndd2/fangming/venvs/routine/lib/python3.8/site-packages/scipy/stats/stats.py:2500: RuntimeWarning: invalid value encountered in true_divide
  return (a - mns) / sstd
09/01/2020 06:06:52 PM 0
09/01/2020 06:06:54 PM 300000
09/01/2020 06:07:46 PM 100000
09/01/2020 06:07:47 PM 400000
09/01/2020 06:08:10 PM 100000
09/01/2020 06:08:39 PM 500000
09/01/2020 06:09:01 PM 200000
09/01/2020 06:09:25 PM 200000
09/01/2020 06:09:32 PM 600000
09/01/2020 06:10:17 PM 300000
09/01/2020 06:10:24 PM 700000
09/01/2020 06:10:40 PM 300000
09/01/2020 06:11:15 PM 800000
09/01/2020 06:11:31 PM 400000
09/01/2020 06:11:55 PM 400000
09/01/2020 06:12:07 PM 900000
09/01/2020 06:12:46 PM 500000
09/01/2020 06:12:59 PM 1000000
09/01/2020 06:13:10 PM 500000
09/01/2020 06:13:50 PM 1100000
09/01/2020 06:14:01 PM 600000
09/01/2020 06:14:25 PM 600000
09/01/2020 06:14:44 PM 1200000
09/01/2020 06:15:15 PM 700000
09/01/2020 06:15:36 PM 1300000
09/01/2020 06:15:41 PM 700000
09/01/2020 06:16:29 PM 1400000
09/01/2020 06:16:30 PM 800000
09/01/2020 06:16:58 PM 800000
09/01/2020 06:17:22 PM 1500000
09/01/2020 06:17:44 PM 900000
09/01/2020 06:18:13 PM 900000
09/01/2020 06:18:16 PM 1600000
09/01/2020 06:18:59 PM 1000000
09/01/2020 06:19:10 PM 1700000
09/01/2020 06:19:28 PM 1000000
09/01/2020 06:20:05 PM 1800000
09/01/2020 06:20:13 PM 1100000
09/01/2020 06:20:43 PM 1100000
09/01/2020 06:20:59 PM 1900000
09/01/2020 06:21:29 PM 1200000
09/01/2020 06:21:53 PM 2000000
09/01/2020 06:22:00 PM 1200000
09/01/2020 06:22:45 PM 1300000
09/01/2020 06:22:47 PM 2100000
09/01/2020 06:23:16 PM 1300000
09/01/2020 06:23:40 PM 2200000
09/01/2020 06:24:01 PM 1400000
09/01/2020 06:24:33 PM 1400000
09/01/2020 06:24:35 PM 2300000
09/01/2020 06:25:16 PM 1500000
09/01/2020 06:25:30 PM 2400000
09/01/2020 06:25:50 PM 1500000
09/01/2020 06:26:32 PM 2500000
09/01/2020 06:26:32 PM 1600000
09/01/2020 06:27:06 PM 1600000
09/01/2020 06:27:33 PM 0
09/01/2020 06:27:48 PM 1700000
09/01/2020 06:28:23 PM 1700000
09/01/2020 06:28:36 PM 100000
09/01/2020 06:29:05 PM 1800000
09/01/2020 06:29:39 PM 1800000
09/01/2020 06:29:39 PM 200000
09/01/2020 06:30:23 PM 1900000
09/01/2020 06:30:42 PM 300000
09/01/2020 06:30:58 PM 1900000
09/01/2020 06:31:42 PM 2000000
09/01/2020 06:31:42 PM 400000
09/01/2020 06:32:17 PM 2000000
09/01/2020 06:32:43 PM 500000
09/01/2020 06:33:00 PM 2100000
09/01/2020 06:33:36 PM 2100000
09/01/2020 06:33:44 PM 600000
09/01/2020 06:34:18 PM 2200000
09/01/2020 06:34:45 PM 700000
09/01/2020 06:34:52 PM 2200000
09/01/2020 06:35:36 PM 2300000
09/01/2020 06:35:46 PM 800000
09/01/2020 06:36:09 PM 2300000
09/01/2020 06:36:47 PM 900000
09/01/2020 06:36:55 PM 2400000
09/01/2020 06:37:26 PM 2400000
09/01/2020 06:37:48 PM 1000000
09/01/2020 06:38:13 PM 2500000
09/01/2020 06:38:43 PM 2500000
09/01/2020 06:38:48 PM 1100000
09/01/2020 06:39:32 PM 0
09/01/2020 06:39:50 PM 1200000
09/01/2020 06:40:00 PM 0
09/01/2020 06:40:52 PM 1300000
09/01/2020 06:40:52 PM 100000
09/01/2020 06:41:18 PM 100000
09/01/2020 06:41:53 PM 1400000
09/01/2020 06:42:11 PM 200000
09/01/2020 06:42:35 PM 200000
09/01/2020 06:42:56 PM 1500000
09/01/2020 06:43:31 PM 300000
09/01/2020 06:43:52 PM 300000
09/01/2020 06:43:59 PM 1600000
09/01/2020 06:44:49 PM 400000
09/01/2020 06:45:02 PM 1700000
09/01/2020 06:45:09 PM 400000
09/01/2020 06:46:05 PM 1800000
09/01/2020 06:46:08 PM 500000
09/01/2020 06:46:25 PM 500000
09/01/2020 06:47:08 PM 1900000
09/01/2020 06:47:27 PM 600000
09/01/2020 06:47:43 PM 600000
09/01/2020 06:48:11 PM 2000000
09/01/2020 06:48:46 PM 700000
09/01/2020 06:49:00 PM 700000
09/01/2020 06:49:13 PM 2100000
09/01/2020 06:50:05 PM 800000
09/01/2020 06:50:16 PM 2200000
09/01/2020 06:50:17 PM 800000
09/01/2020 06:51:17 PM 2300000
09/01/2020 06:51:23 PM 900000
09/01/2020 06:51:36 PM 900000
09/01/2020 06:52:12 PM 2400000
09/01/2020 06:52:42 PM 1000000
09/01/2020 06:52:55 PM 1000000
09/01/2020 06:53:07 PM 2500000
09/01/2020 06:53:58 PM 0
09/01/2020 06:54:00 PM 1100000
09/01/2020 06:54:12 PM 1100000
09/01/2020 06:54:53 PM 100000
09/01/2020 06:55:20 PM 1200000
09/01/2020 06:55:29 PM 1200000
09/01/2020 06:55:49 PM 200000
09/01/2020 06:56:39 PM 1300000
09/01/2020 06:56:45 PM 300000
09/01/2020 06:56:46 PM 1300000
09/01/2020 06:57:41 PM 400000
09/01/2020 06:57:58 PM 1400000
09/01/2020 06:58:03 PM 1400000
09/01/2020 06:58:35 PM 500000
09/01/2020 06:59:18 PM 1500000
09/01/2020 06:59:20 PM 1500000
09/01/2020 06:59:31 PM 600000
09/01/2020 07:00:25 PM 700000
09/01/2020 07:00:37 PM 1600000
09/01/2020 07:00:38 PM 1600000
09/01/2020 07:01:20 PM 800000
09/01/2020 07:01:55 PM 1700000
09/01/2020 07:01:58 PM 1700000
09/01/2020 07:02:15 PM 900000
09/01/2020 07:03:11 PM 1000000
09/01/2020 07:03:13 PM 1800000
09/01/2020 07:03:18 PM 1800000
09/01/2020 07:04:06 PM 1100000
09/01/2020 07:04:32 PM 1900000
09/01/2020 07:04:38 PM 1900000
09/01/2020 07:05:03 PM 1200000
09/01/2020 07:05:50 PM 2000000
09/01/2020 07:05:58 PM 2000000
09/01/2020 07:06:01 PM 1300000
09/01/2020 07:06:58 PM 1400000
09/01/2020 07:07:07 PM 2100000
09/01/2020 07:07:18 PM 2100000
09/01/2020 07:07:54 PM 1500000
09/01/2020 07:08:25 PM 2200000
09/01/2020 07:08:38 PM 2200000
09/01/2020 07:08:49 PM 1600000
09/01/2020 07:09:43 PM 2300000
09/01/2020 07:09:49 PM 1700000
09/01/2020 07:09:58 PM 2300000
09/01/2020 07:10:49 PM 1800000
09/01/2020 07:11:01 PM 2400000
09/01/2020 07:11:18 PM 2400000
09/01/2020 07:11:48 PM 1900000
09/01/2020 07:12:18 PM 2500000
09/01/2020 07:12:36 PM 2500000
09/01/2020 07:12:47 PM 2000000
09/01/2020 07:13:27 PM 0
09/01/2020 07:13:47 PM 2100000
09/01/2020 07:13:48 PM 0
09/01/2020 07:14:44 PM 100000
09/01/2020 07:14:48 PM 2200000
09/01/2020 07:15:07 PM 100000
09/01/2020 07:15:46 PM 2300000
09/01/2020 07:16:00 PM 200000
09/01/2020 07:16:21 PM 2400000
09/01/2020 07:16:25 PM 200000
09/01/2020 07:16:50 PM 2500000
09/01/2020 07:17:16 PM 300000
09/01/2020 07:17:16 PM (2589994,)_(2589994,)_(2589994,)
09/01/2020 07:17:17 PM 2062_1000000
09/01/2020 07:17:43 PM 300000
../correlation_analysis_celllevel-v4-stage3.py:334: RuntimeWarning: divide by zero encountered in true_divide
  fdr = cdf_shuff/cdf
../correlation_analysis_celllevel-v4-stage3.py:334: RuntimeWarning: invalid value encountered in true_divide
  fdr = cdf_shuff/cdf
../correlation_analysis_celllevel-v4-stage3.py:335: RuntimeWarning: invalid value encountered in true_divide
  tracks_hist_ratios[label] = hist/hist_shuff
../correlation_analysis_celllevel-v4-stage3.py:335: RuntimeWarning: divide by zero encountered in true_divide
  tracks_hist_ratios[label] = hist/hist_shuff
09/01/2020 07:18:29 PM 400000
09/01/2020 07:18:56 PM 400000
09/01/2020 07:19:44 PM 500000
09/01/2020 07:20:09 PM 500000
09/01/2020 07:21:00 PM 600000
09/01/2020 07:21:23 PM 600000
09/01/2020 07:22:13 PM 700000
09/01/2020 07:22:36 PM 700000
09/01/2020 07:23:22 PM 800000
09/01/2020 07:23:47 PM 800000
09/01/2020 07:24:32 PM 900000
09/01/2020 07:24:57 PM 900000
09/01/2020 07:25:40 PM 1000000
09/01/2020 07:26:06 PM 1000000
09/01/2020 07:26:48 PM 1100000
09/01/2020 07:27:14 PM 1100000
09/01/2020 07:27:58 PM 1200000
09/01/2020 07:28:27 PM 1200000
09/01/2020 07:29:07 PM 1300000
09/01/2020 07:29:40 PM 1300000
09/01/2020 07:30:19 PM 1400000
09/01/2020 07:30:53 PM 1400000
09/01/2020 07:31:37 PM 1500000
09/01/2020 07:32:09 PM 1500000
09/01/2020 07:32:52 PM 1600000
09/01/2020 07:33:25 PM 1600000
09/01/2020 07:34:07 PM 1700000
09/01/2020 07:34:41 PM 1700000
09/01/2020 07:35:24 PM 1800000
09/01/2020 07:35:58 PM 1800000
09/01/2020 07:36:40 PM 1900000
09/01/2020 07:37:19 PM 1900000
09/01/2020 07:37:57 PM 2000000
09/01/2020 07:38:39 PM 2000000
09/01/2020 07:39:14 PM 2100000
09/01/2020 07:39:59 PM 2100000
09/01/2020 07:40:34 PM 2200000
09/01/2020 07:41:20 PM 2200000
09/01/2020 07:41:55 PM 2300000
09/01/2020 07:42:42 PM 2300000
09/01/2020 07:43:15 PM 2400000
09/01/2020 07:44:06 PM 2400000
09/01/2020 07:44:34 PM 2500000
09/01/2020 07:45:10 PM 2500000
09/01/2020 07:45:20 PM (2589994,)_(2589994,)_(2589994,)
09/01/2020 07:45:21 PM 2062_1000000
09/01/2020 07:45:42 PM (2589994,)_(2589994,)_(2589994,)
09/01/2020 07:45:46 PM 2062_1000000
../correlation_analysis_celllevel-v4-stage3.py:334: RuntimeWarning: divide by zero encountered in true_divide
  fdr = cdf_shuff/cdf
../correlation_analysis_celllevel-v4-stage3.py:334: RuntimeWarning: invalid value encountered in true_divide
  fdr = cdf_shuff/cdf
../correlation_analysis_celllevel-v4-stage3.py:335: RuntimeWarning: invalid value encountered in true_divide
  tracks_hist_ratios[label] = hist/hist_shuff
../correlation_analysis_celllevel-v4-stage3.py:334: RuntimeWarning: divide by zero encountered in true_divide
  fdr = cdf_shuff/cdf
../correlation_analysis_celllevel-v4-stage3.py:334: RuntimeWarning: invalid value encountered in true_divide
  fdr = cdf_shuff/cdf
../correlation_analysis_celllevel-v4-stage3.py:335: RuntimeWarning: invalid value encountered in true_divide
  tracks_hist_ratios[label] = hist/hist_shuff
5000, 5000
09/01/2020 07:46:57 PM  config_atac_scsmart_ka5000_knn5000_200826.py
09/01/2020 07:46:57 PM * Begin integration
09/01/2020 07:46:57 PM Metadata snatac_gene (54844, 13)
sys:1: DtypeWarning: Columns (64) have mixed types.Specify dtype option on import or set low_memory=False.
09/01/2020 07:46:57 PM Metadata smarter_cells (6244, 129)
09/01/2020 07:47:01 PM Feature matrix snatac_gene (6345, 54844)
09/01/2020 07:47:02 PM Feature matrix smarter_cells (5743, 6244)
09/01/2020 07:47:02 PM Done reading data
09/01/2020 07:47:02 PM Subsampling 1/3
09/01/2020 07:47:04 PM snatac_gene (43895, 13) (6345, 43895)
09/01/2020 07:47:05 PM smarter_cells (4999, 129) (5743, 4999)
09/01/2020 07:47:05 PM Smoothing within modalities...
09/01/2020 10:00:03 PM snatac_gene: 7977.9242208004
09/01/2020 10:02:55 PM smarter_cells: 172.0771462917328
09/01/2020 10:02:55 PM Constructing a joint matrix...
09/01/2020 10:02:55 PM Imputing into snatac_gene space...
09/01/2020 10:02:55 PM for snatac_gene cells...
09/01/2020 10:02:55 PM for smarter_cells cells...
09/01/2020 10:12:32 PM Saved output to: /cndd2/fangming/projects/miniatlas/results/pcX_all_mop_2mods_atacrna_200826_ka5000_knn5000.npy.0
09/01/2020 10:12:32 PM Saved output to: /cndd2/fangming/projects/miniatlas/results/cells_all_mop_2mods_atacrna_200826_ka5000_knn5000.npy.0
09/01/2020 10:12:32 PM Done integration into a common PC space
09/01/2020 10:12:32 PM Subsampling 2/3
09/01/2020 10:12:34 PM snatac_gene (43919, 13) (6345, 43919)
09/01/2020 10:12:34 PM smarter_cells (4990, 129) (5743, 4990)
09/01/2020 10:12:34 PM Smoothing within modalities...
09/02/2020 12:05:17 AM snatac_gene: 6762.731969833374
09/02/2020 12:07:44 AM smarter_cells: 146.96862053871155
09/02/2020 12:07:44 AM Constructing a joint matrix...
09/02/2020 12:07:44 AM Imputing into snatac_gene space...
09/02/2020 12:07:44 AM for snatac_gene cells...
09/02/2020 12:07:44 AM for smarter_cells cells...
09/02/2020 12:16:13 AM Saved output to: /cndd2/fangming/projects/miniatlas/results/pcX_all_mop_2mods_atacrna_200826_ka5000_knn5000.npy.1
09/02/2020 12:16:13 AM Saved output to: /cndd2/fangming/projects/miniatlas/results/cells_all_mop_2mods_atacrna_200826_ka5000_knn5000.npy.1
09/02/2020 12:16:13 AM Done integration into a common PC space
09/02/2020 12:16:13 AM Subsampling 3/3
09/02/2020 12:16:14 AM snatac_gene (43815, 13) (6345, 43815)
09/02/2020 12:16:15 AM smarter_cells (4994, 129) (5743, 4994)
09/02/2020 12:16:15 AM Smoothing within modalities...
09/02/2020 02:03:46 AM snatac_gene: 6451.057950973511
09/02/2020 02:06:11 AM smarter_cells: 144.94676733016968
09/02/2020 02:06:11 AM Constructing a joint matrix...
09/02/2020 02:06:11 AM Imputing into snatac_gene space...
09/02/2020 02:06:11 AM for snatac_gene cells...
09/02/2020 02:06:11 AM for smarter_cells cells...
09/02/2020 02:14:46 AM Saved output to: /cndd2/fangming/projects/miniatlas/results/pcX_all_mop_2mods_atacrna_200826_ka5000_knn5000.npy.2
09/02/2020 02:14:46 AM Saved output to: /cndd2/fangming/projects/miniatlas/results/cells_all_mop_2mods_atacrna_200826_ka5000_knn5000.npy.2
09/02/2020 02:14:46 AM Done integration into a common PC space
Time used to build kNN map 0.8060705661773682
Time used to get kNN 811.6578426361084
Time used to build kNN map 0.11551165580749512
Time used to get kNN 21.320513248443604
Time used to build kNN map 0.8474972248077393
Time used to get kNN 734.989058971405
Time used to build kNN map 0.1349194049835205
Time used to get kNN 18.36284041404724
Time used to build kNN map 0.7964351177215576
Time used to get kNN 752.1317219734192
Time used to build kNN map 0.1156761646270752
Time used to get kNN 18.303030729293823
09/02/2020 02:14:57 AM corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka5000_knn5000
09/02/2020 02:14:57 AM Output: /cndd2/fangming/projects/scf_enhancers/results/corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka5000_knn5000_0_corrs.pkl
/cndd2/fangming/projects/scf_enhancers/results/corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka5000_knn5000_0_corrs_idx.pkl
/cndd2/fangming/projects/scf_enhancers/results/figures/corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka5000_knn5000_0_plot1.pdf
/cndd2/fangming/projects/scf_enhancers/results/figures/corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka5000_knn5000_0_plot1_v2.pdf
09/02/2020 02:14:57 AM corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka5000_knn5000
09/02/2020 02:14:57 AM Output: /cndd2/fangming/projects/scf_enhancers/results/corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka5000_knn5000_1_corrs.pkl
/cndd2/fangming/projects/scf_enhancers/results/corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka5000_knn5000_1_corrs_idx.pkl
/cndd2/fangming/projects/scf_enhancers/results/figures/corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka5000_knn5000_1_plot1.pdf
/cndd2/fangming/projects/scf_enhancers/results/figures/corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka5000_knn5000_1_plot1_v2.pdf
09/02/2020 02:14:57 AM corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka5000_knn5000
09/02/2020 02:14:57 AM Output: /cndd2/fangming/projects/scf_enhancers/results/corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka5000_knn5000_2_corrs.pkl
/cndd2/fangming/projects/scf_enhancers/results/corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka5000_knn5000_2_corrs_idx.pkl
/cndd2/fangming/projects/scf_enhancers/results/figures/corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka5000_knn5000_2_plot1.pdf
/cndd2/fangming/projects/scf_enhancers/results/figures/corr_analysis_smarter_cells_snatac_gene_mop_2mods_atacrna_200826_ka5000_knn5000_2_plot1_v2.pdf
09/02/2020 02:14:57 AM <class 'numpy.ndarray'>_(6244,)_cell_smarter_cells.txt
09/02/2020 02:14:57 AM <class 'numpy.ndarray'>_(6244,)_cell_smarter_cells.txt
09/02/2020 02:14:57 AM <class 'numpy.ndarray'>_(6244,)_cell_smarter_cells.txt
09/02/2020 02:14:57 AM <class 'numpy.ndarray'>_(135665,)_cell_snatac_gene.txt
09/02/2020 02:14:57 AM <class 'numpy.ndarray'>_(135665,)_cell_snatac_gene.txt
09/02/2020 02:14:57 AM <class 'numpy.ndarray'>_(135665,)_cell_snatac_gene.txt
09/02/2020 02:14:57 AM <class 'numpy.ndarray'>_(32324,)_gene_smarter_cells.txt
09/02/2020 02:14:57 AM <class 'numpy.ndarray'>_(32324,)_gene_smarter_cells.txt
09/02/2020 02:14:57 AM <class 'numpy.ndarray'>_(32324,)_gene_smarter_cells.txt
09/02/2020 02:14:58 AM <class 'pandas.core.frame.DataFrame'>_(233514, 3)_enh.tsv
09/02/2020 02:14:58 AM <class 'pandas.core.frame.DataFrame'>_(233514, 3)_enh.tsv
09/02/2020 02:14:58 AM <class 'pandas.core.frame.DataFrame'>_(233514, 3)_enh.tsv
09/02/2020 02:15:00 AM <class 'scipy.sparse.csc.csc_matrix'>_(32324, 6244)_mat_smarter_cells.npz
09/02/2020 02:15:00 AM <class 'scipy.sparse.csc.csc_matrix'>_(32324, 6244)_mat_smarter_cells.npz
09/02/2020 02:15:01 AM <class 'scipy.sparse.csc.csc_matrix'>_(32324, 6244)_mat_smarter_cells.npz
09/02/2020 02:15:02 AM <class 'scipy.sparse.csc.csc_matrix'>_(233514, 135665)_mat_atac_snatac_gene.npz
09/02/2020 02:15:02 AM <class 'scipy.sparse.csc.csc_matrix'>_(233514, 135665)_mat_atac_snatac_gene.npz
09/02/2020 02:15:03 AM <class 'scipy.sparse.csc.csc_matrix'>_(233514, 135665)_mat_atac_snatac_gene.npz
09/02/2020 02:15:11 AM (4994, 43815)_(4994, 4994)_(32324, 4994)_(233514, 43815)
09/02/2020 02:15:13 AM (4990, 43919)_(4990, 4990)_(32324, 4990)_(233514, 43919)
09/02/2020 02:15:14 AM (4999, 43895)_(4999, 4999)_(32324, 4999)_(233514, 43895)
09/02/2020 02:38:15 AM (32324, 4994)_(233514, 4994)
09/02/2020 02:38:36 AM (32324, 4990)_(233514, 4990)
09/02/2020 02:38:49 AM (32324, 4999)_(233514, 4999)
/cndd2/fangming/venvs/routine/lib/python3.8/site-packages/scipy/stats/stats.py:2500: RuntimeWarning: invalid value encountered in true_divide
  return (a - mns) / sstd
09/02/2020 02:42:40 AM 0
/cndd2/fangming/venvs/routine/lib/python3.8/site-packages/scipy/stats/stats.py:2500: RuntimeWarning: invalid value encountered in true_divide
  return (a - mns) / sstd
09/02/2020 02:42:59 AM 0
/cndd2/fangming/venvs/routine/lib/python3.8/site-packages/scipy/stats/stats.py:2500: RuntimeWarning: invalid value encountered in true_divide
  return (a - mns) / sstd
09/02/2020 02:43:07 AM 0
09/02/2020 02:44:02 AM 100000
09/02/2020 02:44:23 AM 100000
09/02/2020 02:44:30 AM 100000
09/02/2020 02:45:25 AM 200000
09/02/2020 02:45:46 AM 200000
09/02/2020 02:45:55 AM 200000
09/02/2020 02:46:46 AM 300000
09/02/2020 02:47:08 AM 300000
09/02/2020 02:47:17 AM 300000
09/02/2020 02:48:06 AM 400000
09/02/2020 02:48:29 AM 400000
09/02/2020 02:48:39 AM 400000
09/02/2020 02:49:26 AM 500000
09/02/2020 02:49:51 AM 500000
09/02/2020 02:50:01 AM 500000
09/02/2020 02:50:48 AM 600000
09/02/2020 02:51:11 AM 600000
09/02/2020 02:51:23 AM 600000
09/02/2020 02:52:09 AM 700000
09/02/2020 02:52:30 AM 700000
09/02/2020 02:52:45 AM 700000
09/02/2020 02:53:30 AM 800000
09/02/2020 02:53:52 AM 800000
09/02/2020 02:54:06 AM 800000
09/02/2020 02:54:51 AM 900000
09/02/2020 02:55:13 AM 900000
09/02/2020 02:55:26 AM 900000
09/02/2020 02:56:11 AM 1000000
09/02/2020 02:56:34 AM 1000000
09/02/2020 02:56:47 AM 1000000
09/02/2020 02:57:33 AM 1100000
09/02/2020 02:57:56 AM 1100000
09/02/2020 02:58:08 AM 1100000
09/02/2020 02:58:56 AM 1200000
09/02/2020 02:59:18 AM 1200000
09/02/2020 02:59:31 AM 1200000
09/02/2020 03:00:18 AM 1300000
09/02/2020 03:00:40 AM 1300000
09/02/2020 03:00:55 AM 1300000
09/02/2020 03:01:40 AM 1400000
09/02/2020 03:02:02 AM 1400000
09/02/2020 03:02:17 AM 1400000
09/02/2020 03:03:03 AM 1500000
09/02/2020 03:03:25 AM 1500000
09/02/2020 03:03:39 AM 1500000
09/02/2020 03:04:27 AM 1600000
09/02/2020 03:04:48 AM 1600000
09/02/2020 03:05:04 AM 1600000
09/02/2020 03:05:51 AM 1700000
09/02/2020 03:06:11 AM 1700000
09/02/2020 03:06:29 AM 1700000
09/02/2020 03:07:14 AM 1800000
09/02/2020 03:07:36 AM 1800000
09/02/2020 03:07:53 AM 1800000
09/02/2020 03:08:38 AM 1900000
09/02/2020 03:09:01 AM 1900000
09/02/2020 03:09:19 AM 1900000
09/02/2020 03:10:02 AM 2000000
09/02/2020 03:10:26 AM 2000000
09/02/2020 03:10:44 AM 2000000
09/02/2020 03:11:26 AM 2100000
09/02/2020 03:11:51 AM 2100000
09/02/2020 03:12:08 AM 2100000
09/02/2020 03:12:50 AM 2200000
09/02/2020 03:13:15 AM 2200000
09/02/2020 03:13:32 AM 2200000
09/02/2020 03:14:14 AM 2300000
09/02/2020 03:14:39 AM 2300000
09/02/2020 03:14:57 AM 2300000
09/02/2020 03:15:37 AM 2400000
09/02/2020 03:16:03 AM 2400000
09/02/2020 03:16:20 AM 2400000
09/02/2020 03:16:59 AM 2500000
09/02/2020 03:17:27 AM 2500000
09/02/2020 03:17:43 AM 2500000
09/02/2020 03:18:19 AM 0
09/02/2020 03:18:49 AM 0
09/02/2020 03:19:04 AM 0
09/02/2020 03:19:42 AM 100000
09/02/2020 03:20:12 AM 100000
09/02/2020 03:20:28 AM 100000
09/02/2020 03:21:04 AM 200000
09/02/2020 03:21:34 AM 200000
09/02/2020 03:21:50 AM 200000
09/02/2020 03:22:26 AM 300000
09/02/2020 03:22:55 AM 300000
09/02/2020 03:23:12 AM 300000
09/02/2020 03:23:47 AM 400000
09/02/2020 03:24:16 AM 400000
09/02/2020 03:24:32 AM 400000
09/02/2020 03:25:07 AM 500000
09/02/2020 03:25:37 AM 500000
09/02/2020 03:25:54 AM 500000
09/02/2020 03:26:28 AM 600000
09/02/2020 03:26:58 AM 600000
09/02/2020 03:27:15 AM 600000
09/02/2020 03:27:49 AM 700000
09/02/2020 03:28:19 AM 700000
09/02/2020 03:28:36 AM 700000
09/02/2020 03:29:12 AM 800000
09/02/2020 03:29:40 AM 800000
09/02/2020 03:29:57 AM 800000
09/02/2020 03:30:33 AM 900000
09/02/2020 03:31:01 AM 900000
09/02/2020 03:31:19 AM 900000
09/02/2020 03:31:54 AM 1000000
09/02/2020 03:32:21 AM 1000000
09/02/2020 03:32:41 AM 1000000
09/02/2020 03:33:14 AM 1100000
09/02/2020 03:33:42 AM 1100000
09/02/2020 03:34:01 AM 1100000
09/02/2020 03:34:37 AM 1200000
09/02/2020 03:35:04 AM 1200000
09/02/2020 03:35:23 AM 1200000
09/02/2020 03:35:58 AM 1300000
09/02/2020 03:36:26 AM 1300000
09/02/2020 03:36:44 AM 1300000
09/02/2020 03:37:19 AM 1400000
09/02/2020 03:37:49 AM 1400000
09/02/2020 03:38:07 AM 1400000
09/02/2020 03:38:42 AM 1500000
09/02/2020 03:39:09 AM 1500000
09/02/2020 03:39:30 AM 1500000
09/02/2020 03:40:04 AM 1600000
09/02/2020 03:40:32 AM 1600000
09/02/2020 03:40:52 AM 1600000
09/02/2020 03:41:28 AM 1700000
09/02/2020 03:41:55 AM 1700000
09/02/2020 03:42:16 AM 1700000
09/02/2020 03:42:51 AM 1800000
09/02/2020 03:43:19 AM 1800000
09/02/2020 03:43:39 AM 1800000
09/02/2020 03:44:14 AM 1900000
09/02/2020 03:44:42 AM 1900000
09/02/2020 03:45:03 AM 1900000
09/02/2020 03:45:37 AM 2000000
09/02/2020 03:46:05 AM 2000000
09/02/2020 03:46:26 AM 2000000
09/02/2020 03:46:59 AM 2100000
09/02/2020 03:47:28 AM 2100000
09/02/2020 03:47:48 AM 2100000
09/02/2020 03:48:22 AM 2200000
09/02/2020 03:48:51 AM 2200000
09/02/2020 03:49:10 AM 2200000
09/02/2020 03:49:43 AM 2300000
09/02/2020 03:50:14 AM 2300000
09/02/2020 03:50:34 AM 2300000
09/02/2020 03:51:06 AM 2400000
09/02/2020 03:51:36 AM 2400000
09/02/2020 03:51:56 AM 2400000
09/02/2020 03:52:28 AM 2500000
09/02/2020 03:52:59 AM 2500000
09/02/2020 03:53:18 AM 2500000
09/02/2020 03:53:42 AM 0
09/02/2020 03:54:13 AM 0
09/02/2020 03:54:31 AM 0
09/02/2020 03:55:05 AM 100000
09/02/2020 03:55:35 AM 100000
09/02/2020 03:55:54 AM 100000
09/02/2020 03:56:28 AM 200000
09/02/2020 03:56:58 AM 200000
09/02/2020 03:57:18 AM 200000
09/02/2020 03:57:49 AM 300000
09/02/2020 03:58:19 AM 300000
09/02/2020 03:58:39 AM 300000
09/02/2020 03:59:10 AM 400000
09/02/2020 03:59:40 AM 400000
09/02/2020 04:00:01 AM 400000
09/02/2020 04:00:31 AM 500000
09/02/2020 04:01:03 AM 500000
09/02/2020 04:01:21 AM 500000
09/02/2020 04:01:52 AM 600000
09/02/2020 04:02:24 AM 600000
09/02/2020 04:02:42 AM 600000
09/02/2020 04:03:14 AM 700000
09/02/2020 04:03:45 AM 700000
09/02/2020 04:04:02 AM 700000
09/02/2020 04:04:36 AM 800000
09/02/2020 04:05:05 AM 800000
09/02/2020 04:05:23 AM 800000
09/02/2020 04:05:55 AM 900000
09/02/2020 04:06:26 AM 900000
09/02/2020 04:06:41 AM 900000
09/02/2020 04:07:16 AM 1000000
09/02/2020 04:07:46 AM 1000000
09/02/2020 04:08:02 AM 1000000
09/02/2020 04:08:35 AM 1100000
09/02/2020 04:09:06 AM 1100000
09/02/2020 04:09:22 AM 1100000
09/02/2020 04:09:58 AM 1200000
09/02/2020 04:10:28 AM 1200000
09/02/2020 04:10:43 AM 1200000
09/02/2020 04:11:21 AM 1300000
09/02/2020 04:11:50 AM 1300000
09/02/2020 04:12:05 AM 1300000
09/02/2020 04:12:43 AM 1400000
09/02/2020 04:13:11 AM 1400000
09/02/2020 04:13:27 AM 1400000
09/02/2020 04:14:05 AM 1500000
09/02/2020 04:14:34 AM 1500000
09/02/2020 04:14:49 AM 1500000
09/02/2020 04:15:28 AM 1600000
09/02/2020 04:15:56 AM 1600000
09/02/2020 04:16:12 AM 1600000
09/02/2020 04:16:52 AM 1700000
09/02/2020 04:17:19 AM 1700000
09/02/2020 04:17:36 AM 1700000
09/02/2020 04:18:15 AM 1800000
09/02/2020 04:18:44 AM 1800000
09/02/2020 04:19:00 AM 1800000
09/02/2020 04:19:39 AM 1900000
09/02/2020 04:20:07 AM 1900000
09/02/2020 04:20:24 AM 1900000
09/02/2020 04:21:02 AM 2000000
09/02/2020 04:21:30 AM 2000000
09/02/2020 04:21:47 AM 2000000
09/02/2020 04:22:23 AM 2100000
09/02/2020 04:22:52 AM 2100000
09/02/2020 04:23:09 AM 2100000
09/02/2020 04:23:46 AM 2200000
09/02/2020 04:24:14 AM 2200000
09/02/2020 04:24:31 AM 2200000
09/02/2020 04:25:09 AM 2300000
09/02/2020 04:25:36 AM 2300000
09/02/2020 04:25:54 AM 2300000
09/02/2020 04:26:32 AM 2400000
09/02/2020 04:26:57 AM 2400000
09/02/2020 04:27:17 AM 2400000
09/02/2020 04:27:54 AM 2500000
09/02/2020 04:28:18 AM 2500000
09/02/2020 04:28:37 AM 2500000
09/02/2020 04:29:08 AM (2589994,)_(2589994,)_(2589994,)
09/02/2020 04:29:08 AM 2062_1000000
qt.qpa.xcb: could not connect to display localhost:11.0
qt.qpa.plugin: Could not load the Qt platform plugin "xcb" in "" even though it was found.
This application failed to start because no Qt platform plugin could be initialized. Reinstalling the application may fix this problem.

Available platform plugins are: eglfs, minimal, minimalegl, offscreen, vnc, webgl, xcb.

xargs: ../correlation_analysis_celllevel-v4-stage3.py: terminated by signal 6
Command exited with non-zero status 125
57375.01user 31107.75system 17:25:05elapsed 141%CPU (0avgtext+0avgdata 63593052maxresident)k
9379168inputs+126306512outputs (51519major+3915702515minor)pagefaults 0swaps
09/02/2020 04:29:20 AM (2589994,)_(2589994,)_(2589994,)
09/02/2020 04:29:20 AM 2062_1000000
qt.qpa.xcb: could not connect to display localhost:11.0
qt.qpa.plugin: Could not load the Qt platform plugin "xcb" in "" even though it was found.
This application failed to start because no Qt platform plugin could be initialized. Reinstalling the application may fix this problem.

Available platform plugins are: eglfs, minimal, minimalegl, offscreen, vnc, webgl, xcb.

09/02/2020 04:29:26 AM (2589994,)_(2589994,)_(2589994,)
09/02/2020 04:29:26 AM 2062_1000000
qt.qpa.xcb: could not connect to display localhost:11.0
qt.qpa.plugin: Could not load the Qt platform plugin "xcb" in "" even though it was found.
This application failed to start because no Qt platform plugin could be initialized. Reinstalling the application may fix this problem.

Available platform plugins are: eglfs, minimal, minimalegl, offscreen, vnc, webgl, xcb.

